<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Godout - O seu Parceiro em Gerenciamento de Projetos</title>
    
    <link rel="stylesheet" href="style/style.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">    
    
</head>
<body>
    <div class="container">
        <a href="home.html" class="logo">Godout</a>
        <div class="form-card form-group">

            <form action="../controller/userController.php?action=login" method="post">
                    <h2>Login</h2>
                    <hr>
                    <br>
                    <label for="txtEmail">Email
                        <input type="text" name="txtEmail" id="txtEmail" placeholder="Usuario@gmail.com" class="btn">
                    </label>
                    
                    <label for="txtPsw">Senha
                        <input type="password" name="senhaPSW" id="txtPsw" placeholder="Digite sua senha" class="input">
                    </label>

                    <button type="submit">Login</button>
                    <p>Se não tiver uma conta, <a href="cadastro.html">cadastre-se</a> ao invés disso</p>
                    <p><a href="areaUsuario.html"> Teste Here</a></p>
                </form>
            <br>
            <button class="btn btn-primary" id="google-sign-in-button" style="min-width: 45%; background-color: white; color: black; border: 0.5px solid black; margin-right: 4%;">Google</button>
            <button class="btn btn-primary" style="min-width: 45%; background-color: white; color: black; border: 0.5px solid black;">Microsoft</button>
        </div>
    </div>
    <script>
        // app.js ou login.js (onde você tem o botão do Google)
    
        // 1. Importar os módulos do Firebase que você precisa
        // (Estas linhas você pode manter onde inicializa o Firebase ou criar um novo arquivo para autenticação)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-analytics.js";
        
        // Importe o módulo de autenticação e suas funções específicas!
        import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js";
        
        
        // 2. Sua configuração do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDAcynqZp8KMgzcPZH2Ze5OEaFtWzMcwtk",
            authDomain: "projhub-cc8c2.firebaseapp.com",
            projectId: "projhub-cc8c2",
            storageBucket: "projhub-cc8c2.firebasestorage.app",
            messagingSenderId: "264400081700",
            appId: "1:264400081700:web:186829ee9d7d548fd4d9b1",
            measurementId: "G-VX0WXTYPK2"
        };
        
        // 3. Inicializar o Firebase (se ainda não estiver inicializado neste arquivo)
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        
        // 4. Obter a instância de autenticação e o provedor Google
        const auth = getAuth(app);
        const googleProvider = new GoogleAuthProvider();
        
        // 5. Encontrar o botão do Google na sua página de login
        // Você deve dar um ID ao seu botão do Google no HTML, por exemplo:
        // <button id="google-sign-in-button" class="btn btn-primary" ...>Google</button>
        const googleSignInButton = document.getElementById('google-sign-in-button');
        
        if (googleSignInButton) {
            googleSignInButton.addEventListener('click', async () => {
                try {
                    const result = await signInWithPopup(auth, googleProvider);
                    // O usuário foi autenticado com sucesso!
                    const user = result.user;
                    console.log("Usuário logado com Google:", user);
                    // Redirecionar para a página inicial
                    window.location.href = 'home.html'; // Ajuste o caminho se necessário
                } catch (error) {
                    // Lidar com erros de autenticação
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.error("Erro de autenticação com Google:", errorCode, errorMessage);
                    // Mostrar uma mensagem de erro para o usuário
                    alert(`Erro ao fazer login com Google: ${errorMessage}`);
                }
            });
        }
        
        // Opcional: Monitorar o estado de autenticação para manter o usuário logado
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // Usuário está logado
                console.log("Usuário já logado:", user.displayName);
                // Você pode redirecionar para 'home.html' automaticamente se o usuário tentar acessar a página de login já logado
                // window.location.href = 'home.html';
            } else {
                // Usuário não está logado
                console.log("Nenhum usuário logado no momento.");
            }
        });
    </script>
    <script src="scriptTema.js"></script>
</body>
</html>
